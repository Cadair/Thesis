%*****************************************************************************************
%*********************************** Second Chapter ***************************************
%*****************************************************************************************
\label{ch:Background}
\chapter{Background}  %Title of the Second Chapter

\begin{pycode}[chapter2]
ch2 = texfigure.Manager(pytex, number=2, base_path='./Chapter2/')
\end{pycode}

%{\Large Knowledge at start:}
%\begin{itemize}
%	\item The coronal heating problem
%	\item MHD waves as a solution to the corona heating problem
%	\item photospheric dynamics
%	\item Magnetic wave guides.
%\end{itemize}
%
%{\Large Knowledge at end:}
%\begin{itemize}
%	\item The ideal MHD equations
%	\item Wave solutions for a uniform media
%	\item velocity perturbation calculations
%	\item Wave flux calcs
%	\item SAC, and numerical solutions to the ideal MHD equations
%\end{itemize}

%\section*{Outline}
%
%\begin{enumerate}
%
%	\item MHD
%	\begin{enumerate}
%		\item Ideal MHD
%		\item MHD Waves
%		
%	\end{enumerate}
%	\item Computational Methods
%	\begin{enumerate}
%		\item Numerical Solutions to Partial Differential Equations
%		\item Numerical MHD
%		\item The Sheffield Advanced Code (SAC)
%	\end{enumerate}
%	\item Magneto-static Background Conditions
%	
%\end{enumerate}
	

%********************************** %First Section  **************************************
\section{Magnetohydrodynamics}\label{sec:MHD}

Ideal magnetohydrodynamics (MHD) is the description of a plasma as a single perfectly conducting fluid.
This description of the plasma has certain constraints on it's validity, but as we will see, for the purposes of study in the thesis, the ideal MHD equations are a very applicable description of the plasma in the solar atmosphere.
The first and primary assumption of the nature of the plasma the MHD description makes is that it behaves like a fluid.
This means that there are very frequent collisions between the particles comprising the plasma.
Connected to this is the assumption that the temperature of the electrons and the ions are equal, implying that there are frequent interactions between the two species, and that the plasma can be treated as a single fluid.
Secondly, the MHD description is only valid in a certain window of temporal and length scales.
The characteristic length of the plasma has to be sufficiently large so that the particle motion around the magnetic field, the kinetic effects, can be ignored.
The temporal scales also have to be substantially longer than the frequency of the kinetic motions.
However, the temporal scale has to be short enough that the slow dissipative effects, such as resistive decay of the magnetic field, can be neglected.
Two other approximations are made, which enable the description of the plasma as a single fluid, these are the quasi-neutrality assumption, which is the assumption that there are very similar numbers of positive and negative charges present in the plasma; and the assumptions that the relative velocities of the positive and negative charges are small.
Finally, but very importantly, it is assumed that the plasma is non-relativistic, i.e. the motion of the plasma is substantially smaller than the speed of light.
The application of all these assumptions leads to a formulation of the equations governing the motion of the plasma based on Maxwells equations and the equations of gas dynamics, these are the ideal MHD equations, which are given below:
\newcommand{\condev}{\left(\frac{\partial}{\partial t} + \vec{v}\cdot\nabla\right)}

\begin{align}\label{eq:idealmhd}                                                  
    \dfrac{\partial \rho }{\partial t} + \nabla \cdot (\rho \vec{v}) = 0,
    \tag{Mass Conservation}\\
    %                               
    \rho  \condev\vec{v} + \nabla p - \dfrac{1}{\mu}(\nabla \times \vec{B}) \times \vec{B} - \rho \vec{g} = 0,
    \tag{Equation of Motion}\\
    %
    \frac{\partial}{\partial t} + \vec{v}\cdot\nabla p + \gamma p \nabla \cdot \vec{v}  = 0,
    \tag{Energy Equation}\\
    %
    \dfrac{\partial \mathrm{B}}{\partial t} - \nabla \times (\vec{v} \times \vec{B}) = 0,
    \tag{Induction Equation}
\end{align}
subject to
\begin{align*}
    \nabla \cdot \vec{B} = 0,
    \tag{Solenoidal Condition}\\
    %
    p = \mathrm{k_B} \dfrac{\rho}{\mathrm{m}} \mathrm{T},
    \tag{Ideal Gas Law}\\                        
\end{align*}
Where $\rho$ is the density, $\vec{v}$ is the velocity, $p$ is the pressure, $\gamma$ is the ratio of specific heats ($5/3$), $\vec{B}$ is the magnetic field, $\mathrm{k_B}$ is Boltzmann's constant, $\mathrm{m}$ is the mass, $\mathrm{T}$ is the temperature, and $\mu$ is the vacuum permeability \citep{goedbloed2004}.


\subsection{MHD Waves}\label{sec:MHDwaves}
Just like a non-ionised fluid, which supports a sound wave, due to the restoring force of the pressure, plasma supports wave phenomena.
Waves in plasmas also interact with the magnetic field, and the coupling of the magnetic field to the motion of the plasma.
This leads to the presence of a wide variety of wave modes in plasma, dependant upon the geometry and physical properties of the plasma being perturbed.
For the analysis performed in this chapter we shall consider a plasma with a static, and uniform background, the magnetic field shall be of a constant strength and aligned solely to the $z$ axis.
As we shall see, this configuration leads to the existence of three wave modes, called the fast-magnetoacoustic wave, the slow-magnetoacoustic wave and the Alfv\'en wave.

In this section we are going to summarise the derivation of the MHD wave equation for a uniform plasma.
The starting point for this analysis is the ideal MHD equations that are described in \ref{sec:MHD}.
Our static background conditions are described by \ref{eq:linearize} below,
\begin{equation}\label{eq:linearize}
    \begin{aligned}                                                    
        \vec{B} &= \vec{B}_0 + \vec{B}_1(\vec{r},t)\\
        \vec{v} &= 0 + \vec{v}_1(\vec{r},t)\\
        p &= p_0 + {p_1}(\vec{r},t)\\
        \rho &= \rho_0 + {\rho_1}(\vec{r},t)\\
    \end{aligned}
\end{equation}
where a subscript $0$ is the background component, and a subscript $1$ is the perturbation component, and the perturbation component is much smaller than the background component.
Substituting \ref{eq:linearize} into the ideal MHD equations and removing 2nd order or higher terms and any gradients of the background quantities because the background is uniform, leads to the linearised MHD equations given below,
\begin{align}                                                         
    \dfrac{\partial \rho_1 }{\partial t} + \rho_0 (\nabla \cdot \vec{v}_1) =       
    0,
    \tag{Mass Conservation}\\
    %
    \rho_0 \dfrac{\partial \vec{v}_1}{\partial t} =
    -\nabla p_1 + \dfrac{1}{\mu}(\nabla \times \vec{B}_1) \times \vec{B}_0 + \rho_1 \vec{g},
    \tag{Equation of Motion}\\
    %
    \dfrac{\partial p_1}{\partial t} + (\vec{v}_1 \cdot \nabla)p_0 - c_s^2 \left( \dfrac{\partial \rho_1}{\partial t} + (\vec{v}_1 \cdot \nabla)\rho_0 \right) = 0,
    \tag{Energy Equation}\\
    %
    \dfrac{\partial \mathrm{B}_1}{\partial t} = \nabla \times (\vec{v}_1 \times \vec{B}_0),
    \tag{Induction Equation}\\
    %
    \nabla \cdot \vec{B}_1 = 0.
    \tag{Solenoid Equation}               
\end{align}

These equations can be solved using plane wave solutions, i.e. solutions of the form $\rho(\vec{r}, t) = \hat{\rho} e^{i(\vec{k}\cdot\vec{r} - \omega t)}$.

\subsection{Velocity Perturbations}\label{sec:Vpert}

\subsection{Calculating Wave Flux}\label{sec:waveflux}

To calculate the relative strengths of the excited waves we compute the `wave energy flux' vector everywhere in the domain.
To do this we use the equation for the wave energy flux given in Equation (2.14) of \cite{leroy1985}.
This equation can be written using notation similar to the rest of this thesis, by applying $\vec{H} = \vec{B}/\mu_0$ and the vector identity $\vec{a} \times (\vec{b} \cdot \vec{c}) = \vec{a} \cdot \vec{c}\vec{b} - \vec{a} \cdot \vec{b}\vec{c}$.
The result is given in \cref{eq:wave_energy} below.
\begin{equation}
\vec{F}_{wave} \equiv \widetilde{p}_k \vec{v} + \frac{1}{\mu_0} \left(\vec{B}_b \cdot \vec{\widetilde{B}}\right) \vec{v} - \frac{1}{\mu_0}\left(\vec{v} \cdot \vec{\widetilde{B}} \right) \vec{B}_b,
\label{eq:wave_energy}
\end{equation}
where a subscript $b$ represents a background variable, a tilda represents a perturbation from the background conditions and $p_k$ represents kinetic pressure.

The validity of this equation for the wave energy flux is widely discussed, while it can be derived by linearising the total MHD energy flux to the second order, as described in \cite{leroy1985}, it is only one of many solutions to the fundamental energy conservation equation.
This fact is discussed in detail in Section 4 of \cite{bogdan2003}, where the utility of this method of calculating wave energy flux for numerical simulations of the solar atmosphere is considered.
\cite{bogdan2003} compares the above definition of the wave energy flux to the total nonlinear MHD energy flux, it is shown that the total energy flux is dominated by a `stationary flow` of energy, or local effects, rather than the energy contained in the wave like phenomena that this thesis wishes to study.
It is because of this that this method of quantifying the energy contained within the MHD waves generated in the simulation domain is chosen.
It should not however, be taken as a perfect metric, which is why it is chosen only to use \cref{eq:wave_energy} to calculate the relative strengths of the wave modes.
This analysis provides us the desired result: an understanding of how the different plasma conditions and wave drives change the spectra of MHD wave modes generated, while eliminating any concern about the accuracy of \cref{eq:wave_energy} when accounting for absolute energy values.

\section{Computational Methods}\label{sec:numericalmethods}

\section{Sheffield Advanced Code}\label{sec:SAC}