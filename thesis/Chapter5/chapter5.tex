% !TeX root = ../smumford_thesis.tex
%*****************************************************************************************
%*********************************** Fith Chapter ****************************************
%*****************************************************************************************

\chapter[]{Effects of Expansion Factor on Logarithmic Spiral MHD Wave Excitation\footnote{This chapter is based on Mumford and Erd\'elyi (2015) which is licensed under the terms of the CC-BY 4.0 License.}}\label{ch:expfac}

\begin{pycode}[chapter5]
from __future__ import print_function
ch5 = texfigure.Manager(pytex, number=5, base_path='./Chapter5/')

from streamlines import Streamlines

BL = np.array([0.015, 0.05, 0.15, 0.45, 1.5])

import td_plotting_helpers as ph

from sacconfig import SACConfig

cfg = SACConfig()
\end{pycode}

This chapter will investigate the effect of logarithmic spiral-type velocity drivers in the solar photosphere and their properties as MHD wave generation mechanisms.
\Cref{ch:drivers} studied five representative photospheric velocity fields as drivers for MHD waves.
It was concluded that the logarithmic, Archemedian and uniform spiral drivers all generate similar ($\pm 10\%$) excited energy fluxes.
One of the parameters selected arbitrarily in \cref{ch:drivers} was the expansion factors for the logarithmic and Archemedian spirals.
This chapter analyses the effects of the spiral expansion factor on the MHD waves generated by these velocity fields, motivated by the observational studies and constraints of \cite{bonet2008}.
In \cite{bonet2008} magnetic bright points (MBPs) were observed spiralling in an inter-granular lane, where cold plasma sinks down into the convection zone.
\cite{bonet2008} fit the observed locations of the MBP with time to the equation for a logarithmic spiral, shown in \cref{eq:log_spiral},
\begin{equation}
\theta = \frac{1}{B_L}\ln\left(\frac{r}{a}\right),
\label{eq:log_spiral}
\end{equation}
\citep{feynman1964} where $r$ is the radius of the spiral and $a$ is a positive real constant, and obtained a value of $B_L^{-1} = 6.4 \pm 1.6 = B_L = 0.15$ for the dimensionless expansion factor parameter.

In \cite{bonet2010} a larger sample of photospheric vortices were studied, despite not fitting spirals to the observed motions, a number density of photospheric vortices was calculated as $d \simeq 3.1 \times 10^{-3}$ vortices Mm$^{-2}$ minute$^{-1}$, which therefore provides an upper limit of the number of logarithmic spiral-like vortices in the solar photosphere.

This chapter investigates the role of the spiral expansion factor ($B_L$) in the generation of MHD waves in a non-potential Gaussian magnetic flux tube, embedded in a realistic stratified solar atmosphere.
The observational result of \cite{bonet2008} is used as a starting point and values $\pm 3\times$ and $\pm 10\times$ that value are then employed to give five points in the parameter space, centred around their result, which is illustrated in \cref{fig:B-L-values}.


\section{Simulation Configuration}\label{sec:simconfig}
The numerical domain used for the simulations described in this chapter is identical to that used in \cref{ch:drivers} and described in \cref{sec:mhsbackground}.
This magnetohydrostatic background is perturbed during the simulations using a 3D Gaussian weighted logarithmic spiral velocity driver, as described by \cref{eq:slog5,eq:Slog}:
\begin{subequations}
    \begin{align}
    V_x &= A \frac{\cos(\theta + \phi)}{\sqrt{x^2 + y^2}}\ e^{-\left(\frac{z^2}{\Delta z^2} + \frac{x^2}{\Delta x^2} + \frac{y^2}{\Delta y^2}\right)} \sin \left(2\pi \frac{t}{P}\right),\\
    V_y &= - A \frac{\sin(\theta + \phi)}{\sqrt{x^2 + y^2}}\ e^{-\left(\frac{z^2}{\Delta z^2} + \frac{x^2}{\Delta x^2} + \frac{y^2}{\Delta y^2}\right)} \sin \left(2\pi \frac{t}{P}\right),
    \end{align}
    \label{eq:slog5}
\end{subequations}
where:
\begin{equation*}
\theta = \tan^{-1}\left(\frac{y}{x}\right),\ \phi = \tan^{-1}\left(\frac{1}{B_L}\right),\notag	
\end{equation*}
$A=\frac{20}{\sqrt{3}}$, $\Delta x = \Delta y = 0.1$ Mm and $\Delta z = 0.05$ and $P=\py[chapter5]|int(cfg.period)|$ s.
Here, $B_L$ is the logarithmic spiral expansion factor discussed above  \citep{mumford2015}.

\Cref{fig:All_log_spirals} shows the calculated velocity profiles for the peak vertical height of the driver.
Overplotted on these profiles are streamlines that trace a logarithmic spiral with different expansion factors.

\begin{pycode}[chapter5]
size = list(texfigure.figsize(pytex))
size[1] = 1.5
fig, ax = plt.subplots(figsize=size)
ax.plot(BL, np.ones(BL.size), 'x', markersize=10, mew=2)
ax.errorbar([0.15], [1], xerr=np.array([[-1*(0.15-1/(6.4-1.6)), 0.15+1/(6.4+1.6)]]).T, mew=2, elinewidth=2)
ax.semilogx()
ax.get_yaxis().set_visible(False)
ax.set_frame_on(False)
ax.get_xaxis().tick_bottom()
ax.xaxis.set_tick_params(width=2)
ax.xaxis.set_tick_params(width=2, which='minor')
ax.xaxis.set_major_formatter(matplotlib.ticker.ScalarFormatter())
ax.xaxis.set_ticks(BL)
xmin, xmax, ymin, ymax = ax.axis()
ax.add_artist(plt.Line2D((xmin, xmax), (ymin, ymin), color='black', linewidth=1.4))
l = ax.set_xlim([0.01, 2.0])
l = ax.set_xlabel(r'$B_L$', fontsize=18)

fig.tight_layout(h_pad=0.01)
#bL_line = save_fig(cfg, fig=fig, fname='bline.pdf')

bL_line = ch5.save_figure('B-L-values', fig, fext='.pgf')
bL_line.caption = r"The parameter space of $B_L$ used in this work, with the $x$-axis on a logarithmic scale. The green error bars show the fit uncertainty of the value observed by \citet{bonet2008}."
\end{pycode}

\py[chapter5]|bL_line|

\begin{pycode}[chapter5]
#Use Equation 1 to calculate the vector field in a 2D plane to plot it.
time = np.linspace(0,60,480)
dt = time[1:] - time [:-1]
period = 240.

x = np.linspace(7812.5,1992187.5,128)
y = np.linspace(7812.5,1992187.5,128)

x_max = x.max()
y_max = y.max()

xc = 1.0e6
yc = 1.0e6

xn = x - xc
yn = y - yc

delta_x=0.1e6
delta_y=0.1e6

xx, yy = np.meshgrid(xn,yn)
exp_y = np.exp(-(yn**2.0/delta_y**2.0))
exp_x = np.exp(-(xn**2.0/delta_x**2.0))

exp_x2, exp_y2= np.meshgrid(exp_x,exp_y)
exp_xyz = exp_x2 * exp_y2


#==============================================================================
# Define Driver Equations and Parameters
#==============================================================================
#A is the amplitude, B is the spiral expansion factor
A = 1

#Tdamp defines the damping of the driver with time, Tdep is the ocillator
tdamp = lambda time1: 1.0 #*np.exp(-(time1/(period)))
tdep = lambda time1: np.sin((time1*2.0*np.pi)/period) * tdamp(time1)

#Define a peak index to use for scaling in the inital frame
max_ind = np.argmax(tdep(time) > 0.9998)

def get_log(B):
    #Logarithmic
    phi = np.arctan2(1,B)
    theta = np.arctan2(yy,xx)
    
    uy = np.sin(theta + phi)
    ux =  np.cos(theta + phi)
    
    vx = lambda time1: (ux / np.sqrt(ux**2 + uy**2)) * exp_xyz * tdep(time1) * A
    vy = lambda time1: (uy / np.sqrt(ux**2 + uy**2)) * exp_xyz * tdep(time1) * A
    
    vv = np.sqrt(vx(time[max_ind])**2 + vy(time[max_ind])**2)
    
    return vx, vy, vv

width = 0.495
blfigs = texfigure.MultiFigure(3, 2, reference="All_log_spirals")
for bl in BL:
    fig, ax = plt.subplots(figsize=texfigure.figsize(pytex, width),
                           gridspec_kw={'bottom':0.25, 'top':0.95})
    #============================================================================
    # Do the Plotting
    #============================================================================
    vx, vy, vv = get_log(bl)
    # Calculate Streamline
    slines = Streamlines(x,y,vx(time[max_ind]),vy(time[max_ind]),maxLen=7000,
    x0=xc, y0=yc, direction='forwards')
    
    im = ax.imshow(vv, cmap='Blues', extent=[7812.5,x_max,7812.5,y_max])
    im.set_norm(matplotlib.colors.Normalize(vmin=0,vmax=1))
    #ax.hold()
    
    Sline, = ax.plot(slines.streamlines[0][0],slines.streamlines[0][1],color='red',linewidth=2, zorder=40)
    
    #Add colourbar
    divider = make_axes_locatable(ax)
    cax = divider.append_axes("right", size="5%", pad=0.2)
    cbar = plt.colorbar(im,cax)
    cbar.set_label(r"$|V|$ [ms$^{-1}$]")
    scalar = matplotlib.ticker.ScalarFormatter(useMathText=False,useOffset=False)
    scalar.set_powerlimits((-3,3))
    cbar.formatter = scalar
    cbar.ax.yaxis.get_offset_text().set_visible(True)
    cbar.update_ticks()
    #cbar.solids.set_rasterized(True)
    cbar.solids.set_edgecolor("face")
    
    #Add quiver plot overlay
    #qu = ax.quiver(x,y,vx(time[max_ind]),vy(time[max_ind]),scale=25*A,color='k',zorder=20, linewidth=1)
    ax.axis([8.0e5,12.0e5,8.0e5,12.0e5])
    
    ax.xaxis.set_major_formatter(scalar)
    ax.yaxis.set_major_formatter(scalar)
    ax.xaxis.set_major_locator(matplotlib.ticker.MaxNLocator(4))
    ax.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(5))
    ax.xaxis.get_offset_text().set_visible(False)
    ax.yaxis.get_offset_text().set_visible(False)
    ax.set_xlabel("X [Mm]")
    ax.set_ylabel("Y [Mm]")
    
    #plt.tight_layout()
    
    Fig = ch5.save_figure('driver-{}'.format(bl).replace('.', '-'), fig)
    Fig.subfig_width = r'{}\columnwidth'.format(width)
    Fig.caption = r'$B_L = {}$'.format(bl)
    
    blfigs.append(Fig)
   
blfigs.caption = r"Cuts in the [$x$-$y$] plane through the driving velocity field. The magnitude of velocity is plotted in blue with velocity vectors overplotted in black and a streamline seeded at the centre plotted in red. A plot is shown for each value of $B_L$ used in the simulations."

\end{pycode}

\py[chapter5]|blfigs|

\section{Analysis}\label{sec:analysis}

The analysis of these simulations proceeds in the same manner as the analysis described in \cref{sec:fluxsurfaces,sec:driveranalysis}.
The flux surfaces are constructed and the velocity vector and wave flux vectors are decomposed in to the flux surface frame.
These vectors are then used to identify and quantify the wave modes propagating within the domain, as described in \cref{sec:Vpert}.
The wave flux vector, calculated using \cref{eq:wave_energy}, is used to quantify the relative strengths of the components, as discussed in \cref{sec:waveflux}.

%TODO: R: more details (in terms of Physics) (2x)
\subsection{Results}\label{subsec:expfac-results}

To assist in the visualisation and analysis of the results provided by the flux surfaces the vector components along one field line are extracted for all time steps and plotted as time-distance diagrams in \cref{fig:TD-velocity-r30,fig:TD-flux-r30}.

Combining the decomposed velocity vector plotted in \cref{fig:TD-velocity-r30} and the decomposed wave flux vector plotted in \cref{fig:TD-flux-r30} we can reliably describe the nature of the waves generated in the simulations.
Overplotted on all panels in \cref{fig:TD-velocity-r30,fig:TD-flux-r30} are the phase speeds for the background conditions, the dot-dashed line is the fast speed $v_f$, the dashed line is the sound speed $c_s$, the dotted line is the Alfv\'en speed $v_A$ and the solid line is the slow speed $v_s$.
By comparing these characteristic wave mode speeds to the ridges in the time-distance diagrams it can be seen that in the panels for the torsional component (third panel in each figure), the dominant perturbation travels with the Alfv\'en speed (solid line).
We interpret this perturbation as an Alfv\'en wave.
For the perpendicular component (second panels) it can be seen that the dominant perturbation travels with the fast speed (dashed line), therefore this perturbation could be interpreted as a fast mode.
We can infer that this perturbation is more likely to be a sausage mode perturbation due to the radial nature of the driver, in that it should not perturb the axis of the flux tube and, that we observe no significant displacement on the flux surfaces during the simulation.
The most interesting result is shown for the parallel component (top panel in each figure), where for lower values of $B_L$, the amplitudes are low, but the perturbations that are present travel with the fast speed (dotted line).
However, as $B_L$ increases the perturbations change form.
There seems to appear a second, superimposed perturbation travelling with a speed close to that of the slow (or tube) speeds.
This second perturbation seems to grow proportionally to $B_L$, and can be seen to be dominant in \cref{fig:TD-flux-r30-045,fig:TD-flux-r30-15}.

The wave flux graphs in \cref{fig:TD-flux-r30} are components normalised to the magnitude of the wave flux vector, thus showing the relative strengths of the components.
Taking \cref{fig:TD-flux-r30-0015} for the $B_L=\py[chapter5]|BL[0]|$ spiral it can be seen that most of the excited wave flux is in the azimuthal component, associated with the Alfv\'en wave.
As the expansion factor ($B_L$) increases, the driver becomes more radial, and the flux starts to shift from the azimuthal component into the parallel component.
This is interpreted as a change of the dominant mode from the torsional Alfv\'en wave into a superposition of the fast and slow modes, with dominant velocity perturbations parallel to the field lines.
Considering the range of $B_L$, found by \cite{bonet2008} and illustrated in the range spanned by \cref{fig:TD-velocity-r30-015,fig:TD-velocity-r30-045}, it can be seen that even within this parameter range the parallel component becomes substantially more dominant, meaning the change in spectrum of excited MHD wave modes is sensitive to the expansion factor of a spiral driver.

In \cref{ch:drivers} it was observed that there is a small but significant percentage of the wave energy flux contained in the perpendicular component.
This appears to be inversely coupled to the spiral expansion factor of the driver, as it decreases proportionally with the azimuthal wave flux component.
The size of the perpendicular component is also inversely proportional to the initial radius of the flux surface, as can be seen by its decrease in the three panels of \cref{fig:expfac-flux-comparison}.

\begin{pycode}[chapter5]
pflux_labels = {'par_label':r'$V_\parallel$ [ms$^{-1}$]', 
                'perp_label':r'$V_\perp$ [ms$^{-1}$]',
                'phi_label':r'$V_\phi$ [ms$^{-1}$]'}
beta = False

width = 0.9
figsize = list(texfigure.figsize(pytex, scale=width))
figsize[1] = 1.2*figsize[1]

def add_triple_phase(ax, tube_r):
    ps = ph.get_phase_speeds(cfg, tube_r)
    for ax0 in ax:
        ph.add_phase_speeds(ax0, color='g', **ps)
    
Vtd1 = texfigure.MultiFigure(2, 1)
Vtd1.caption = ''
Vtd2 = texfigure.MultiFigure(2, 1)
Vtd2.caption = ''
Vtd3 = texfigure.MultiFigure(1, 1, 'TD-velocity-r30')
Vtd2.frontmatter += '\n' + r'\ContinuedFloat'
Vtd3.frontmatter += '\n' + r'\ContinuedFloat'
for j, bl in enumerate(BL):
    cfg.exp_fac = bl
    
    fig, ax = plt.subplots(nrows=3, ncols=1, sharex=True, figsize=figsize)
    
    kwargs = ph.get_single_velocity(cfg, 'r30', beta=beta)
    kwargs.update(pflux_labels)
    
    ph.triple_plot(ax, **kwargs)
    
    #Remove the top two x labels
    ax[0].set_xlabel('')
    ax[1].set_xlabel('')
    add_triple_phase(ax, 'r30')
    #add_all_bpert(ax, 'r30')
    fig.tight_layout(h_pad=0.05)
    Fig = ch5.save_figure('TD-velocity-r30-{}'.format(str(bl).replace('.','')), fig, fext='.pdf')
    Fig.caption = r'$B_L = {}$'.format(bl)
    Fig.subfig_width = r'{}\columnwidth'.format(width)

    if j < 2:
        Vtd1.append(Fig)
    elif j < 4:
        Vtd2.append(Fig)
    else:
        Vtd3.append(Fig)

Vtd3.caption = r"Velocity time-distance diagrams for all simulated values of $B_L$ for the surface with an initial top radius of $468$ km. Shown in green are the phase speeds for the background conditions, the dot-dashed line is the fast speed $v_f$, the dashed line is the sound speed $c_s$, the dotted line is the Alfv\'en speed $v_A$ and the solid line is the slow speed $v_s$. Note that plasma $\beta > 1$ for all heights in the domain."

\end{pycode}

\py[chapter5]|Vtd1|
\py[chapter5]|Vtd2|
\py[chapter5]|Vtd3|

\begin{pycode}[chapter5]
pflux_labels = {'par_label':r'$F_\parallel^2 / F^2', 
                'perp_label':r'$F_\perp^2 / F^2',
                'phi_label':r'$F_\phi^2 / F^2'}
beta = False

def add_triple_phase(ax, tube_r):
    ps = ph.get_phase_speeds(cfg, tube_r)
    for ax0 in ax:
        ph.add_phase_speeds(ax0, color='c', **ps)


Ftd1 = texfigure.MultiFigure(2, 1)
Ftd1.caption = ''
Ftd2 = texfigure.MultiFigure(2, 1)
Ftd2.caption = ''
Ftd3 = texfigure.MultiFigure(1, 1, 'TD-flux-r30')
Ftd2.frontmatter += '\n' + r'\ContinuedFloat'
Ftd3.frontmatter += '\n' + r'\ContinuedFloat'
for j, bl in enumerate(BL):
    cfg.exp_fac = bl
    
    fig, ax = plt.subplots(nrows=3, ncols=1, sharex=True, figsize=figsize)
    
    kwargs = ph.get_single_percentage_flux(cfg, 'r30', beta=beta)
    kwargs.update(pflux_labels)
    kwargs.update({'cmap': 'PRGn'})
    
    ph.triple_plot(ax, **kwargs)
    #Remove the top two x labels
    ax[0].set_xlabel('')
    ax[1].set_xlabel('')
    add_triple_phase(ax, 'r30')
    #add_all_bpert(ax, 'r30')
    fig.tight_layout(h_pad=0.05)
    Fig = ch5.save_figure('TD-flux-r30-{}'.format(str(bl).replace('.','')), fig)
    Fig.caption = r'$B_L = {}$'.format(bl)
    Fig.subfig_width = r'{}\columnwidth'.format(width)

    if j < 2:
        Ftd1.append(Fig)
    elif j < 4:
        Ftd2.append(Fig)
    else:
        Ftd3.append(Fig)

Ftd3.caption = r"Normalised wave energy flux time-distance diagrams for all simulated values of $B_L$ for the surface with an initial top radius of $468$ km. Shown in blue are the phase speeds for the background conditions, the dot-dashed line is the fast speed $v_f$, the dashed line is the sound speed $c_s$, the dotted line is the Alfv\'en speed $v_A$ and the solid line is the slow speed $v_s$. Note that plasma $\beta > 1$ for all heights in the domain."
\end{pycode}

\py[chapter5]|Ftd1|
\py[chapter5]|Ftd2|
\py[chapter5]|Ftd3|


This change in excitation of MHD waves is summarised in \cref{fig:expfac-flux-comparison}, where the average value of normalised wave flux $\displaystyle\frac{F_{\parallel, \perp, \phi}^2}{F_\parallel^2 + F_\perp^2 + F_\phi^2}$ for all time is plotted.
\Cref{fig:expfac-flux-comparison} shows that, between the values of $B_L=0.15$ and $B_L=0.45$ there is a turning point where the torsional component becomes less dominant, with expansion factors larger than $0.15$ having the parallel component being the dominant component.
This turning point occurs within the range of the fitted spirals in \cite{bonet2008} and, therefore, implies that photospheric spirals may indeed generate a variety of different MHD modes with varying strengths.

\begin{pycode}[chapter5]
int_periods = np.floor(600./cfg.period)*180

def calc_avgs(tube_r):
    AvgsP = np.zeros([3,len(BL)])
    for i, bl in enumerate(BL):
        cfg.exp_fac = bl
        
        times = np.load(os.path.join(cfg.data_dir, 'Times_{}.npy'.format(cfg.get_identifier())))
        max_index = np.argmin(np.abs(int_periods - times))
        
        Fpar, Fperp, Fphi = map(np.load, ph.glob_files(cfg, tube_r, 'LineFlux*Fp*npy'))
        #Fpar, Fperp, Fphi = map(np.load, ph.glob_files(cfg, tube_r, '*vp*npy'))
        Fpar[np.abs(Fpar)<1e-5], Fperp[np.abs(Fperp)<1e-5], Fphi[np.abs(Fphi)<1e-5] = 0., 0., 0.
        Fpar, Fperp, Fphi = Fpar[:max_index,:], Fperp[:max_index,:], Fphi[:max_index,:]
        
        Ftot2 = (Fpar**2 + Fperp**2 + Fphi**2)
        Fpar2, Fperp2, Fphi2 = np.array([Fpar, Fperp, Fphi])**2
        FparP, FperpP, FphiP = (Fpar2/Ftot2)*100, (Fperp2/Ftot2)*100, (Fphi2/Ftot2)*100
        
        FparP = np.mean(np.ma.masked_array(FparP, np.isnan(FparP)))
        FperpP = np.mean(np.ma.masked_array(FperpP, np.isnan(FperpP)))
        FphiP = np.mean(np.ma.masked_array(FphiP, np.isnan(FphiP)))
        
        AvgsP[:, i] = FparP, FperpP, FphiP
    return AvgsP

figsize = texfigure.figsize(pytex,height_ratio=1.2)
fig, axs = plt.subplots(nrows=3, figsize=figsize, sharex=True)
titles = ["Flux Surface Radius $=156$ km", "Flux Surface Radius $=468$ km", "Flux Surface Radius $=936$ km"]
tubes = []
for i, ax in enumerate(axs):
    AvgsP = calc_avgs(cfg.tube_radii[i])
    tubes.append(AvgsP)
    ax.semilogx()
    ax.plot(BL, AvgsP[0], 'o', label=r"$F_\parallel^2$", mew=0, ms=10)
    ax.plot(BL, AvgsP[1], '_', label=r"$F_\perp^2$", mew=2, ms=10)
    ax.plot(BL, AvgsP[2], 'x', label=r"$F_\phi^2$", mew=2, ms=10)
    ax.set_ylabel("% Square Wave Flux")
    ax.set_title(titles[i])
    ax.xaxis.set_major_formatter(matplotlib.ticker.ScalarFormatter())
    ax.xaxis.set_ticks(BL)
    ax.set_xlim([0.01, 2.01])
    ax.set_ylim([0, 85])
    err = np.array([-1*(0.15-1/(6.4-1.6)), 0.15+1/(6.4+1.6)])
    ax.fill_betweenx(np.linspace(-5,105), err[0], err[1], alpha=0.3, color='green', linewidth=0)

axs[0].legend(loc=9)
axs[-1].set_xlabel("Logarithmic Spiral Expansion Factor ($B_L$)")

plt.tight_layout()
ch5bar = ch5.save_figure('expfac-flux-comparison', fig, fext='.pgf')
ch5bar.caption = r"Comparison of percentage square wave energy flux for all simulations and all calculated flux surfaces, plotted against spiral expansion factor on a log scale. The parallel component of wave energy flux is shown as blue circles, the perpendicular component as green dashes and the azimuthal component as red crosses. The green shaded region shows the fit uncertainty in the value observed in \citet{bonet2008}"
\end{pycode}

\py[chapter5]|ch5bar|

%TODO: R: more here
\section{Conclusions}

This chapter presented a parameter study of the logarithmic spiral expansion factor.
This parameter controls how tightly wound the logarithmic spiral is, a series of values were chosen around an observed value from \cite{bonet2008}.
The simulations that were run with expansion factors less than $B_L=0.15$ (the value in \cite{bonet2008}), result in the Alfv\'en wave being dominant, with the exception of the $156$ km flux surface.
The behaviour of the wave modes on the $156$ km flux surface is worthy of note, the $F_\phi$ and $F_\perp$ components, attributed to the Alfv\'en and slow modes respectively, track each other closely for all values of the expansion factor.
This has two potential interpretations, firstly, that the slow mode and the Alfv\'en mode, close to the axis of the magnetic flux tube are both weakened equally as the expansion factor increases or secondly, that there is some coupling between the perturbations in both the $F_\phi$ and $F_\perp$ components.
It can be seen that this link between the $F_\phi$ and $F_\perp$ components can not be seen in the results from the $936$ km surface, and to a substantially lesser extent in the $468$ km surface results.

As the expansion period increases beyond $B_L=0.15$ the $F_\parallel$ component becomes dominant, with $\approx 80$\% of the flux being in the $F_\parallel$ component for $B_L=1.5$ and the $156$ km surface.
As can be seen in \cref{fig:All_log_spirals} the driver profile for $B_L=1.5$ is largely radial, making it expected that some significant change in the wave mode distribution would occur.
The results shown in \cref{fig:TD-velocity-r30-15,fig:TD-flux-r30-15} resemble those of the vertical driver simulated in \cref{ch:drivers} and the results in \cref{fig:All-TD-wave-30:Slog,fig:All-Flux-percent-TD:Slog}.
This is probably a result of the spherical geometry of the problem, as it is interpreted by the author as both drivers exciting sausage mode oscillations.

The next chapter will investigate the relative strengths of the wave modes as period is varied for the logarithmic spiral driver.

