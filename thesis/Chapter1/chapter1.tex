% !TeX root = ../smumford_thesis.tex
%*****************************************************************************************
%*********************************** First Chapter ***************************************
%*****************************************************************************************
\label{ch:Intro}
\chapter{Introduction}  %Title of the First Chapter

\begin{pycode}[chapter1]
ch1 = texfigure.Manager(pytex, number=1, base_path='./Chapter1/')
\end{pycode}

%{\Large Inital Assumptions:}
%\begin{itemize}
%	\item Understanding of the fusion power source.
%	\item Understanding of basic thermodynamics and hydrodynamics.
%	\item Basic understanding of the concepts of EM.
%	\item Understanding of differential equations etc.
%	\item Comprehension of numerical solutions to differential equations, and their ability to solve physical problems.
%\end{itemize}
%
%
%{\Large Outline}
%\begin{enumerate}
%	\item What's a Sun??
%	\item Solar stratification.
%	\item The Coronal Heating problem / energy deficit.
%	\item Potential solutions and MHD waves. (Maths in Chapter 2)
%	\item Photospheric dynamics, granulation, MBPs etc.
%	\item Magnetic structures and wave guides.
%\end{enumerate}


%********************************** %First Section  **************************************
\section{The Sun} %Section - 1.1
The Sun has been the subject of study by humanity since the dawn of civilisation.
The processes in the Sun and in its atmosphere have a direct impact on life on Earth.
The radiation that reaches the Earth provides the energy life needs to flourish and the interaction of the solar wind with the upper atmosphere generates the aurora.
Modern study of the Sun focuses on understanding the processes that drive changes in the Sun such as total radiation output and dramatic events such as solar flares or coronal mass ejections.

The properties and behaviour of the Sun change dramatically with distance from the centre of the Sun.
The core of the Sun is where the nuclear fusion reaction occurs, this region is the source of energy for the Sun and the rest of the plasma above this layer transports this energy to the photosphere and beyond.
Above the solar core the first large region of plasma is the region where energy transport by radiation dominates, this region is very dense and it takes a single high energy photon approximately $170,000$ years to travel outwards from the core to the photosphere \citep{priest2014}.
This radiative zone extends out to $0.7$ R$_\odot$ \citep{priest2014}, at that point a narrow region called the tachocline exists, where the plasma stops rotating as a solid body, and starts rotating with different velocities at different latitudes.
Above this tachocline radial energy transport is dominated by convective motions, this convective zone extends out to the visible surface or photosphere.
The convective plasma motions that move hot plasma up to the photosphere are responsible for a lot of the interesting features and properties of the photosphere and higher layers of the solar atmosphere.
The photosphere is the point where the Sun becomes mostly transparent to light, it is defined as the region where $\frac{2}{3}$ of the light can escape the solar atmosphere entirely.
However, it is the photosphere and the layers above it that have the most direct influence on the Earth.

The solar atmosphere is often described by various distinctive vertically stratified layers, the lowest of which is the photosphere.
At the top of the photosphere there is a point named the temperature minimum, at this point the temperature of the Sun is at its lowest, around $4,500$ K.
Above the photosphere, there is a region called the chromosphere, so named because of the colourful emission lines, such as H$\alpha$ which dominate it's emission.
From the chromosphere upwards a drastic change in plasma properties occur.
The plasma density drops rapidly and the temperature increases, this is named the transition region and is the focus of much study.
Above this region is the solar corona, which is a low density, high temperature region, were the effects of magnetic field are totally dominant.
The changes in Temperature and Density from the photosphere to the low corona is shown in Figure~\ref{fig:atmos}.

\begin{pycode}[chapter1]
#TODO: Use Fred's new pysac routines here?!
from astropy import constants
from astropy.table import Table
"""
Load in data from Table 12 in Vernazza 1981,
data is:
    H(km) | \rho (g cm^-3) | Ptot (dyn cm^-2) | T (K) | Pgas / Ptot
and in McWhirter 1975 data is:
    H(km) | T (K)          | Ptot (dyn cm^-2) | Pgas / Ptot (?)
"""

val3c = Table.read(ch1.data_file("VALIIIC.dat"),
				  names=('H', 'rho', 'Ptot', 'T', 'Pgas / Ptot'),
				  format='ascii')
tunits=(u.km, u.Unit('g cm^-3'), u.Unit('dyn cm^-2'), u.K, u.dimensionless_unscaled)
val3c = dict((col, u.Quantity(val3c[col], unit=tunits[i]).si.decompose()) for i, col in enumerate(val3c.colnames))

mwdata = Table.read(ch1.data_file("mcwhirter.dat"),
				  names=('H', 'T', 'Ptot', 'Pgas / Ptot'),
				  format='ascii', comment='#')
mwdata = mwdata[:-1]
tunits=(u.km, u.K, u.Unit('dyn cm^-2'), u.dimensionless_unscaled)
mwdata = dict((col, u.Quantity(mwdata[col], unit=tunits[i]).si.decompose()) for i, col in enumerate(mwdata.colnames))

mu = 0.602  # mean molecullar weight fully ionized 0.908 H 0.092 He
mwdata['rho'] = (mwdata['Ptot'] / constants.k_B / mwdata['T'] * constants.m_p * mu).decompose()

mwdata['H'] = mwdata['H'].to(u.Mm)
val3c['H'] = val3c['H'].to(u.Mm)

fig, ax = plt.subplots()

lt, = ax.semilogy(mwdata['H'], mwdata['T'], 'gx')
ax.semilogy(val3c['H'], val3c['T'], 'gx')

ax.set_xlabel("Height [{}]".format(mwdata['H'].unit.to_string()))
ax.set_ylabel("Temperature [{}]".format(mwdata['T'].unit.to_string(format='latex')))

ax2 = ax.twinx()

lrho, = ax2.semilogy(mwdata['H'], mwdata['rho'], 'bx')
ax2.semilogy(val3c['H'], val3c['rho'], 'bx')

ax2.set_ylabel(r"Density [{}]".format(mwdata['rho'].unit.to_string(format='latex')))
ax2.set_xlim(0,6)

# Set the colours for the ticks and the labels.
ax2.tick_params(axis='y', colors=lrho.get_color())
ax.tick_params(axis='y', colors=lt.get_color())

ax2.yaxis.label.set_color(lrho.get_color())
ax.yaxis.label.set_color(lt.get_color())

fig.tight_layout()
atmos = ch1.save_figure('atmos', fig=fig, fext='.pgf')
atmos.caption="Density (blue) and Temperature (green) profiles of the solar atmosphere, above the photosphere, combining the \cite{mcwhirter1975} and \cite{vernazza1981} models."
\end{pycode}

\py[chapter1]|atmos|


The solar corona (Figure~\ref{fig:aia171}) is very hot, with temperatures exceeding 10 Million degrees Kelvin, however, it is also very rarefied, with densities of the order of \py[chapter1]|np.round(mwdata['rho'][-1], 10)|.
%TODO: FIX THIS VALUE
This means that the energy density of the corona is much lower than that of the lower layers of the solar atmosphere, \textit{e.g.} the photosphere, where the temperature is of the order of $5,000$ K.
In spite of this the solar corona requires a constant energy input in the region of $300$ W/m$^2$ \citep{priest2014} to maintain its high temperatures.
There is currently no understood mechanism which transports this energy, from the photosphere, through the transition region and into the corona.
The energy transport in the Sun is understood up to just above the photosphere, it is dominated by either radiation or convection.
In the layers of the atmosphere above the temperature minimum, there is no longer an obvious mechanism transporting the observed quantities of energy.
Convection and conduction are both unable to transport enough energy due to the density being too low.
Radiation is also ruled out due to the optical depth being too high, primarily due to the low density.
While certain regions of the chromosphere have more complex thermal characteristics, the statements above hold for the corona.
Therefore, another energy transport mechanism has to be heating the solar atmosphere, from the chromosphere, to the corona.


\begin{pycode}[chapter1]
from sunpy.net import vso
from sunpy.time import parse_time
import sunpy.map

vc = vso.VSOClient()
res = vc.query(vso.attrs.Time('2015/8/28', parse_time('now'), parse_time('now')), vso.attrs.Instrument('AIA'), vso.attrs.Wave(17.1*u.nm, 17.1*u.nm))
filepath = vc.get(res, site='UCLan', path='{}/{{file}}'.format(ch1.data_dir)).wait()[0]

# Add the file to the pytex data
ch1.pytex.add_created(filepath)

map171 = sunpy.map.Map(filepath)

map171.peek(basic_plot=True)

aia171 = ch1.save_figure('aia171', fext='.pdf')
aia171.caption="The solar corona at 17.1 nm, showing plasma in the region of 1 million degrees Kelvin. Taken by the AIA instrument on the SDO spacecraft on {date:%d %b %Y at %H:%M}".format(date=map171.date)
\end{pycode}

\py[chapter1]|aia171|

\section{Coronal Heating}

To maintain the temperature of the solar atmosphere, especially the corona, energy has to be transported from the photosphere upwards.
The mechanism by which this happens is unknown, however, it is very widely accepted that it involves the solar magnetic field.
One key reason for this is that, to a first approximation, the magnetic field in the solar atmosphere extends vertically away from the Sun.
It therefore, connects the layers of the solar atmosphere together, providing a corridor for potential energy transport.

The magnetic field is thought to be generated in the tachocline, the region between the radiative and convection zones.
It then is convected up with the plasma to the photosphere, where it emerges and forms magnetic structures on various scales in the atmosphere.
These structures rage from, small Magnetic Bright Points (MBPs) to massive coronal loops.

Initially, we can think of the plasma in the solar atmosphere as perfectly conducting, meaning that the field lines are `frozen-in' to the plasma.
This means that if one parcel of plasma is connected to a magnetic field line, it will be connected to that same field line for all time.
The effect this has, is that plasma motions move the field lines, and magnetic forces affect the plasma.
If we consider the region around the base of the photosphere, the top of the convection zone, where hot plasma tied to magnetic field is rising, cooling and then sinking.
We can foresee a situation where this turbulent motion at the photosphere transfers kinetic energy from the plasma into the magnetic field.

Two leading mechanisms have been proposed, by which this energy given to the magnetic field could heat the atmosphere, magnetic reconnection and magnetohydrodynamic (MHD) waves.
Magnetic reconnection, is where the plasma is no longer perfectly conducting and the `frozen-in' condition no longer applies.
The magnetic field, under high stress, will reconfigure itself and in the process transfer a large amount of energy into plasma motions.
This reconnection mechanism is widely thought to be the driving forces behind some of the largest explosive events observed on the Sun, such as Coronal Mass Ejections (CMEs) and solar flares.
It is also thought to be a good way to transfer magnetic energy into the plasma in the corona.
The second, MHD waves, are the focus of the rest of this thesis.
MHD waves have the potential to heat the corona by using the magnetic structures that span the solar atmosphere as wave guides.
MHD waves excited in the photosphere, then travel up along the magnetic field lines, higher up in the atmosphere these wave motions are damped, by some mechanism, thereby transferring their energy into the surrounding plasma.
These waves can occur in all scales of magnetic structures, from small scale photospheric flux tubes, to giant coronal loops.
The driving mechanism for both these energy transfer mechanism are the plasma motions in, and below, the photosphere.
It is therefore important to understand the properties of the solar photosphere.

\section{The Photosphere} 

\begin{pycode}[chapter1]
import sunpy.map

fig = plt.figure()
mm = sunpy.map.Map(ch1.data_file('gband_image_00200.fits'))
mm = mm.submap([-440,440]*u.arcsec, [-440,440]*u.arcsec)
mm.plot_settings['cmap'] = 'hot'
mm.plot_settings['title'] = ''
mm.plot()

fig.tight_layout()
fig.subplots_adjust(bottom=0.15)
photosphere = ch1.save_figure('gband', fig)
photosphere.caption = "A G-Band image of the solar photosphere."
\end{pycode}

\py[chapter1]|photosphere|

The photosphere is the easiest layer of the solar atmosphere to observe, as it dominates all emission from the Sun.
It is a highly dynamic place where hot plasma, having risen through the convection zone, cools and then sinks.
The plasmas interaction with the magnetic field in the photosphere is obvious through various structures observed in the photosphere.
These structures vary from the large sunspots, which can be multiple times the size of the Earth, to the small MBPs.
As well as these magnetic structures there are various scales of convection cells observed in the photosphere, commonly named granulation.
Granulation is the observation of the top of a convection cell, where the hot plasma rises in the centre of the granulation cell and then cools and sinks around the edges.
The smallest and most prominent scale of granulation is shown in Figure~\ref{fig:gband}.

As previously mentioned the plasma and the magnetic field are generally locked together, this means that the convective motions of the plasma have an effect on the magnetic field in the photosphere.
The horizontal motion of the plasma at the top of the granulation cells, as it moves from the hot core to the cool edges, causes a build up of magnetic field in the lanes between then cells.
It is in these regions that MBPs are formed, by this accumulation of magnetic field.

MBPs are one structure of particular importance for the rest of this thesis.
Small scale magnetic structures, like MBPs, are exceedingly common over the solar photosphere and therefore could have a cumulative effect if they are conduits for even small amounts of energy into the higher regions of the atmosphere.
In combination with this, they are highly dynamic structures, formed in the chaotic inter-granular lanes, where the plasma is driven by the horizontal convective motions as well as the down drafts from the sinking plasma.
These plasma motions, in combination with the magnetic fields, are almost certain to drive MHD waves of some variety. 
The rest of this thesis is going to explore the generation of MHD waves in photospheric magnetic structures similar in properties to a MBP.

\Cref{ch:Background} will provide the theoretical background, while \cref{ch:methodology} describes the numerical configuration and analysis methodology for the simulations that are described in \cref{ch:drivers,ch:expfac,ch:period}, finally the conclusions are summarised in \cref{ch:conclusions}.
